import{_ as s,o as n,c as a,a as l}from"./app.cf68ed47.js";const i=JSON.parse('{"title":"\u65E5\u5FD7\u6A21\u5757","description":"","frontmatter":{},"headers":[{"level":2,"title":"\u8F93\u51FA\u65E5\u5FD7","slug":"\u8F93\u51FA\u65E5\u5FD7","link":"#\u8F93\u51FA\u65E5\u5FD7","children":[]},{"level":2,"title":"\u8F93\u51FA\u5F02\u5E38\u65E5\u5FD7","slug":"\u8F93\u51FA\u5F02\u5E38\u65E5\u5FD7","link":"#\u8F93\u51FA\u5F02\u5E38\u65E5\u5FD7","children":[]},{"level":2,"title":"\u521B\u5EFA\u65E5\u5FD7\u6A21\u5757","slug":"\u521B\u5EFA\u65E5\u5FD7\u6A21\u5757","link":"#\u521B\u5EFA\u65E5\u5FD7\u6A21\u5757","children":[]},{"level":2,"title":"\u4FDD\u5B58\u7684\u65E5\u5FD7\u6587\u4EF6","slug":"\u4FDD\u5B58\u7684\u65E5\u5FD7\u6587\u4EF6","link":"#\u4FDD\u5B58\u7684\u65E5\u5FD7\u6587\u4EF6","children":[]},{"level":2,"title":"\u81EA\u5B9A\u4E49\u5168\u5C40\u65E5\u5FD7\u6A21\u5757","slug":"\u81EA\u5B9A\u4E49\u5168\u5C40\u65E5\u5FD7\u6A21\u5757","link":"#\u81EA\u5B9A\u4E49\u5168\u5C40\u65E5\u5FD7\u6A21\u5757","children":[]}],"relativePath":"develop/advanced/logger.md","lastUpdated":1683455999000}'),p={name:"develop/advanced/logger.md"},o=l(`<h1 id="\u65E5\u5FD7\u6A21\u5757" tabindex="-1">\u65E5\u5FD7\u6A21\u5757 <a class="header-anchor" href="#\u65E5\u5FD7\u6A21\u5757" aria-hidden="true">#</a></h1><p>AmiyaBot \u4F7F\u7528 logging \u6A21\u5757\u6784\u5EFA\u65E5\u5FD7\u4F53\u7CFB\u3002</p><h2 id="\u8F93\u51FA\u65E5\u5FD7" tabindex="-1">\u8F93\u51FA\u65E5\u5FD7 <a class="header-anchor" href="#\u8F93\u51FA\u65E5\u5FD7" aria-hidden="true">#</a></h2><p>AmiyaBot \u7684\u65E5\u5FD7\u540C\u6837\u62E5\u6709\u4E0E logging \u76F8\u540C\u7684\u7B49\u7EA7\u8F93\u51FA\u3002\u8F93\u51FA\u7684\u65E5\u5FD7\u4F1A\u50A8\u5B58\u5728 <code>log</code> \u6587\u4EF6\u5939\u4E0B\u3002</p><div class="language-python"><button class="copy"></button><span class="lang">python</span><pre><code><span class="line"><span style="color:#89DDFF;">from</span><span style="color:#A6ACCD;"> amiyabot </span><span style="color:#89DDFF;">import</span><span style="color:#A6ACCD;"> log</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">log</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">info</span><span style="color:#89DDFF;">(</span><span style="color:#82AAFF;">...</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">log</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">error</span><span style="color:#89DDFF;">(</span><span style="color:#82AAFF;">...</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">log</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">debug</span><span style="color:#89DDFF;">(</span><span style="color:#82AAFF;">...</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">log</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">warning</span><span style="color:#89DDFF;">(</span><span style="color:#82AAFF;">...</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">log</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">critical</span><span style="color:#89DDFF;">(</span><span style="color:#82AAFF;">...</span><span style="color:#89DDFF;">)</span></span>
<span class="line"></span></code></pre></div><p>\u65E5\u5FD7\u7684\u56FA\u6709\u683C\u5F0F\u5982\u4E0B\u6240\u793A\uFF0C\u5206\u522B\u4E3A<code>\u65F6\u95F4</code>\u3001<code>\u65E5\u5FD7\u6A21\u5757\u540D</code>\u3001<code>\u65E5\u5FD7\u7B49\u7EA7</code>\u548C<code>\u65E5\u5FD7\u5185\u5BB9</code>\u3002</p><div class="language-"><button class="copy"></button><span class="lang"></span><pre><code><span class="line"><span style="color:#A6ACCD;">2022-11-02 18:22:40,425 [     Bot][    INFO] initialize completed.</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span></code></pre></div><h2 id="\u8F93\u51FA\u5F02\u5E38\u65E5\u5FD7" tabindex="-1">\u8F93\u51FA\u5F02\u5E38\u65E5\u5FD7 <a class="header-anchor" href="#\u8F93\u51FA\u5F02\u5E38\u65E5\u5FD7" aria-hidden="true">#</a></h2><p><code>log.error()</code> \u65B9\u6CD5\u4E0D\u4EC5\u53EF\u4EE5\u4F20\u5165\u5B57\u7B26\u4E32\uFF0C\u4E5F\u652F\u6301\u4F20\u5165 Exception \u7684\u5B50\u7C7B\u3002\u4F20\u5165 Exception \u5B50\u7C7B\u65F6\uFF0C\u5C06\u4F1A\u8F93\u51FA\u5B8C\u6574\u7684\u5F02\u5E38\u8FFD\u8E2A\uFF08Traceback\uFF09\u3002</p><div class="language-python"><button class="copy"></button><span class="lang">python</span><pre><code><span class="line"><span style="color:#89DDFF;">try</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#A6ACCD;">    a </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">0</span></span>
<span class="line"><span style="color:#A6ACCD;">    a </span><span style="color:#89DDFF;">+=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">1</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"><span style="color:#89DDFF;">except</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">Exception</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">as</span><span style="color:#A6ACCD;"> e</span><span style="color:#89DDFF;">:</span></span>
<span class="line highlighted"><span style="color:#A6ACCD;">    log</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">error</span><span style="color:#89DDFF;">(</span><span style="color:#82AAFF;">e</span><span style="color:#89DDFF;">,</span><span style="color:#82AAFF;"> </span><span style="color:#A6ACCD;">desc</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">calc error:</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">)</span></span>
<span class="line"></span></code></pre></div><p>\u5C06\u8F93\u51FA\u5982\u4E0B\u65E5\u5FD7</p><div class="language-"><button class="copy"></button><span class="lang"></span><pre><code><span class="line"><span style="color:#A6ACCD;">2022-11-02 18:44:22,155 [     Bot][   ERROR] calc error: Traceback (most recent call last):</span></span>
<span class="line"><span style="color:#A6ACCD;">  File &quot;F:\\Project\\Amiya-Bot-core\\logTest.py&quot;, line 5, in &lt;module&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">    a += &#39;1&#39;</span></span>
<span class="line"><span style="color:#A6ACCD;">TypeError: unsupported operand type(s) for +=: &#39;int&#39; and &#39;str&#39;</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span></code></pre></div><p>\u5982\u679C\u4F60\u5E76\u4E0D\u9700\u8981\u5904\u7406\u5F02\u5E38\uFF0C\u4EC5\u4EC5\u5E0C\u671B\u5F02\u5E38\u4E0D\u4F1A\u7EC8\u6B62\u4F60\u7684\u7A0B\u5E8F\uFF0Clog \u6A21\u5757\u63D0\u4F9B\u4E86\u4E0A\u4E0B\u6587\u7BA1\u7406\u7684\u65B9\u5F0F\uFF0C\u6765\u6355\u83B7\u5E76\u8F93\u51FA\u5728\u4E0A\u4E0B\u6587\u4E2D\u4EA7\u51FA\u7684\u5F02\u5E38\u3002</p><table><thead><tr><th>\u53C2\u6570\u540D</th><th>\u7C7B\u578B</th><th>\u91CA\u4E49</th><th>\u9ED8\u8BA4\u503C</th></tr></thead><tbody><tr><td>desc</td><td>String</td><td>\u5F02\u5E38\u6807\u9898</td><td></td></tr><tr><td>ignore</td><td>List[]</td><td>\u4EC5\u6355\u83B7\u4F46\u4E0D\u8F93\u51FA\u7684\u5F02\u5E38\u5217\u8868</td><td>None</td></tr><tr><td>handler</td><td>Callable</td><td>\u6355\u83B7\u5F02\u5E38\u540E\u6267\u884C\u7684\u65B9\u6CD5</td><td>None</td></tr></tbody></table><div class="language-python"><button class="copy"></button><span class="lang">python</span><pre><code><span class="line"><span style="color:#C792EA;">async</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">def</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">err_handler</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">err</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">Exception</span><span style="color:#89DDFF;">):</span></span>
<span class="line"><span style="color:#A6ACCD;">    ...</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;"># \u5F02\u6B65\u65B9\u5F0F</span></span>
<span class="line highlighted"><span style="color:#89DDFF;">async</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">with</span><span style="color:#A6ACCD;"> log</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">catch</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">calc error:</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#82AAFF;"> </span><span style="color:#A6ACCD;">ignore</span><span style="color:#89DDFF;">=[</span><span style="color:#FFCB6B;">TypeError</span><span style="color:#89DDFF;">,</span><span style="color:#82AAFF;"> ...</span><span style="color:#89DDFF;">],</span><span style="color:#82AAFF;"> </span><span style="color:#A6ACCD;">handler</span><span style="color:#89DDFF;">=</span><span style="color:#82AAFF;">err_handler</span><span style="color:#89DDFF;">):</span></span>
<span class="line"><span style="color:#A6ACCD;">    ...</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;"># \u540C\u6B65\u65B9\u5F0F</span></span>
<span class="line highlighted"><span style="color:#89DDFF;">with</span><span style="color:#A6ACCD;"> log</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">sync_catch</span><span style="color:#89DDFF;">(</span><span style="color:#82AAFF;">...</span><span style="color:#89DDFF;">):</span></span>
<span class="line"><span style="color:#A6ACCD;">    ...</span></span>
<span class="line"></span></code></pre></div><h2 id="\u521B\u5EFA\u65E5\u5FD7\u6A21\u5757" tabindex="-1">\u521B\u5EFA\u65E5\u5FD7\u6A21\u5757 <a class="header-anchor" href="#\u521B\u5EFA\u65E5\u5FD7\u6A21\u5757" aria-hidden="true">#</a></h2><p>\u4F60\u53EF\u4EE5\u521B\u5EFA\u4E00\u4E2A\u72EC\u7ACB\u7684\u65E5\u5FD7\u6A21\u5757\u4EE5\u6807\u8BB0\u8F93\u51FA\u3002</p><div class="language-python"><button class="copy"></button><span class="lang">python</span><pre><code><span class="line"><span style="color:#89DDFF;">from</span><span style="color:#A6ACCD;"> amiyabot</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">log </span><span style="color:#89DDFF;">import</span><span style="color:#A6ACCD;"> LoggerManager</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">logger </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">LoggerManager</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">MyLogger</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">logger</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">info</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">this is a log.</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;"># 2022-11-02 18:32:05,053 [MyLogger][    INFO] this is a log.</span></span>
<span class="line"></span></code></pre></div><h2 id="\u4FDD\u5B58\u7684\u65E5\u5FD7\u6587\u4EF6" tabindex="-1">\u4FDD\u5B58\u7684\u65E5\u5FD7\u6587\u4EF6 <a class="header-anchor" href="#\u4FDD\u5B58\u7684\u65E5\u5FD7\u6587\u4EF6" aria-hidden="true">#</a></h2><p>\u4FDD\u5B58\u7684\u65E5\u5FD7\u6587\u4EF6\u9ED8\u8BA4\u4E3A running.log\uFF0CLoggerManager \u7684\u6240\u6709\u7B49\u7EA7\u8F93\u51FA\u65B9\u6CD5\u5185\uFF0C\u90FD\u6709\u4E00\u4E2A <code>filename</code> \u53C2\u6570\uFF0C\u53EF\u7528\u4E8E\u6307\u5B9A\u8F93\u51FA\u7684\u6587\u4EF6\u540D\u3002</p><div class="language-python"><button class="copy"></button><span class="lang">python</span><pre><code><span class="line"><span style="color:#A6ACCD;">log</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">info</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">some text.</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#82AAFF;"> </span><span style="color:#A6ACCD;">filename</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">other</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#676E95;"># \u5C06\u8F93\u51FA\u5230 log/other.log \u6587\u4EF6</span></span>
<span class="line"></span></code></pre></div><h2 id="\u81EA\u5B9A\u4E49\u5168\u5C40\u65E5\u5FD7\u6A21\u5757" tabindex="-1">\u81EA\u5B9A\u4E49\u5168\u5C40\u65E5\u5FD7\u6A21\u5757 <a class="header-anchor" href="#\u81EA\u5B9A\u4E49\u5168\u5C40\u65E5\u5FD7\u6A21\u5757" aria-hidden="true">#</a></h2><p>\u5982\u679C\u4F60\u4E0D\u559C\u6B22\u9ED8\u8BA4\u7684\u65E5\u5FD7\u8F93\u51FA\uFF0C\u4F60\u4E5F\u53EF\u4EE5\u5168\u5C40\u4FEE\u6539\u65E5\u5FD7\u6A21\u5757\u3002\u4F46\u5FC5\u987B\u6CE8\u610F\u7684\u4E8B\uFF0C\u4F60\u81EA\u5B9A\u4E49\u7684\u6A21\u5757\uFF0C\u5FC5\u987B\u5305\u542B\u5E38\u89C4\u7684\u51E0\u4E2A\u7B49\u7EA7\u8F93\u51FA\u65B9\u6CD5\u3002</p><div class="language-python"><button class="copy"></button><span class="lang">python</span><pre><code><span class="line"><span style="color:#89DDFF;">from</span><span style="color:#A6ACCD;"> amiyabot</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">log </span><span style="color:#89DDFF;">import</span><span style="color:#A6ACCD;"> UserLogger</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#C792EA;">class</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">Mylogger</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">def</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">info</span><span style="color:#89DDFF;">(</span><span style="color:#F07178;">self</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;">text</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">str</span><span style="color:#89DDFF;">):</span><span style="color:#A6ACCD;"> ...</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">def</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">error</span><span style="color:#89DDFF;">(</span><span style="color:#F07178;">self</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;">text</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">str</span><span style="color:#89DDFF;">):</span><span style="color:#A6ACCD;"> ...</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">def</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">debug</span><span style="color:#89DDFF;">(</span><span style="color:#F07178;">self</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;">text</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">str</span><span style="color:#89DDFF;">):</span><span style="color:#A6ACCD;"> ...</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">def</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">warning</span><span style="color:#89DDFF;">(</span><span style="color:#F07178;">self</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;">text</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">str</span><span style="color:#89DDFF;">):</span><span style="color:#A6ACCD;"> ...</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">def</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">critical</span><span style="color:#89DDFF;">(</span><span style="color:#F07178;">self</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;">text</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">str</span><span style="color:#89DDFF;">):</span><span style="color:#A6ACCD;"> ...</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">UserLogger</span><span style="color:#89DDFF;">.</span><span style="color:#F07178;">logger</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">Mylogger</span><span style="color:#89DDFF;">()</span><span style="color:#A6ACCD;"> </span><span style="color:#676E95;"># \u5C06\u9ED8\u8BA4\u65E5\u5FD7\u5904\u7406\u66FF\u6362\u4E3A\u81EA\u5B9A\u4E49\u7684\u7C7B</span></span>
<span class="line"></span></code></pre></div>`,24),e=[o];function t(c,r,D,F,y,A){return n(),a("div",null,e)}const d=s(p,[["render",t]]);export{i as __pageData,d as default};
